<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>TensorFlow.js TFLite Example</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-tflite"></script>
</head>
<body>
    <h1>TensorFlow.js TFLite Example</h1>
    <button onclick="runPrediction()">Run Prediction</button>

    <script>
        let tfliteModel;

        async function loadModel() {
            const modelUrl = 'https://kurorosuke.github.io/atom_game/save/model.tflite';
            tfliteModel = await tflite.loadTFLiteModel(modelUrl);
            console.log('Model loaded.');
        }

        loadModel();

        async function runPrediction() {
            const elements = {
                "H": 1, "He": 2, "Li": 3, "Be": 4, "B": 5, "C": 6, "N": 7, "O": 8, "F": 9, "Ne": 10,
                "Na": 11, "Mg": 12, "Al": 13, "Si": 14, "P": 15, "S": 16, "Cl": 17, "Ar": 18, "K": 19, "Ca": 20,
                "Fe": 26, "Cu": 29, "Zn": 30, "I": 53
            };

            function convertElement(data) {
                return data.map(elem => elements[elem] || 0);
            }

            const inputHand = ["C", "H", "O", "N", "S", "He", "Li", "Be"];
            const action = 1;
            const inputData = convertElement(inputHand);
            inputData.push(action);
            const inputTensor = tf.tensor2d([inputData], [1, 9], 'float32');

            const prediction = await tfliteModel.predict(inputTensor);
            console.log('Prediction:', prediction.dataSync());
        }
    </script>
</body>
</html>
